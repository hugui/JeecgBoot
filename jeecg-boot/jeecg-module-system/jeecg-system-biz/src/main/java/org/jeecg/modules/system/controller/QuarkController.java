package org.jeecg.modules.system.controller;

import com.alibaba.fastjson.JSONArray;
import io.swagger.annotations.Api;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.compress.utils.Lists;
import org.jeecg.common.api.vo.Result;
import org.jeecg.modules.system.entity.QuarkAccount;
import org.jeecg.modules.system.model.quark.QuarkFileListBo;
import org.jeecg.modules.system.queue.QuarkPanFileManager;
import org.jeecg.modules.system.service.IQuarkAccountService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.stream.Collectors;


@Api(tags = "夸克订阅记录")
@RestController
@RequestMapping("/quark/")
@Slf4j
public class QuarkController {
    @Autowired
    private IQuarkAccountService quarkAccountService;


    @GetMapping(value = "/folders")
    public Result<?> folders(String pdirFid) {
        String json = "[{\"fileName\":\"影视\",\"fid\":\"7506a0c8f1254c95b49e07f6ff3dfa9c\",\"dir\":true,\"sub\":[{\"fileName\":\"纪录片\",\"fid\":\"e2205a62fc2342b0bbffacd6a13fd39d\",\"dir\":true,\"sub\":null},{\"fileName\":\"综艺\",\"fid\":\"3bf455911772413cbc39f60b03a17654\",\"dir\":true,\"sub\":null},{\"fileName\":\"国产剧\",\"fid\":\"eab09f0dca8049208ab2db12a105404a\",\"dir\":true,\"sub\":null},{\"fileName\":\"欧美剧\",\"fid\":\"c43804d4f86b451aa5ca0f4dc34a4451\",\"dir\":true,\"sub\":null},{\"fileName\":\"电影\",\"fid\":\"b04e87cc9596480bbe6fc87e0e89e36b\",\"dir\":true,\"sub\":null},{\"fileName\":\"日韩剧\",\"fid\":\"c046c86453114d9ca43aa807de45033c\",\"dir\":true,\"sub\":null}]},{\"fileName\":\"游戏\",\"fid\":\"cf38940f68084730a3de85f12f3f8867\",\"dir\":true,\"sub\":[{\"fileName\":\"黑神话悟空\",\"fid\":\"ec389edb469f4cc0a1288a739816581b\",\"dir\":true,\"sub\":null},{\"fileName\":\"11 bit studios\",\"fid\":\"f7536751f70c4826b0ecf1f6a797a2bd\",\"dir\":true,\"sub\":null},{\"fileName\":\"艾尔登法环 黄金树之影（ELDEN RING Shadow of the Erdtree）中文版\",\"fid\":\"8ff9788eef7c43dd84bba73342304649\",\"dir\":true,\"sub\":null},{\"fileName\":\"Z 只狼：影逝二度（光头强MOD）\",\"fid\":\"c756e6671b114e5b82ad0b5499e6c631\",\"dir\":true,\"sub\":null},{\"fileName\":\"荒野大镖客2 Red Dead Redemption 2\",\"fid\":\"a008659d65bd4228a1bff59cb3c41969\",\"dir\":true,\"sub\":null},{\"fileName\":\"A076\",\"fid\":\"3b1eb7f4c78d4c02a84a1c6958031afb\",\"dir\":true,\"sub\":null}]},{\"fileName\":\"XPTV_TEMP\",\"fid\":\"7b21f3ce2131417aa10560cc8ed1e12a\",\"dir\":true,\"sub\":[{\"fileName\":\"91726e01616c_打开《盗墓笔记之沙海》玩偶哥哥\",\"fid\":\"04d41529e2d04056a81e84898f4fb485\",\"dir\":true,\"sub\":null},{\"fileName\":\"1317d1e06ebd_打开《终极笔记（臻彩）》玩偶哥哥\",\"fid\":\"2451dac721864da7bd31282d973fde9e\",\"dir\":true,\"sub\":null},{\"fileName\":\"7031a87cd8d3_7031a87cd8d3\",\"fid\":\"77dc85d39e13400c8f874111efe0563c\",\"dir\":true,\"sub\":null},{\"fileName\":\"f56947609885_打开《异形：夺命舰》玩偶哥哥\",\"fid\":\"970021438c5d4422814f91b8ff3158d5\",\"dir\":true,\"sub\":null}]},{\"fileName\":\"我的备份\",\"fid\":\"cd5e04fb9b6049eb865dfe7eb13dcd54\",\"dir\":true,\"sub\":[{\"fileName\":\"iPhone 14 Pro 备份\",\"fid\":\"60fe1528024e4f2b99aef53b7e162856\",\"dir\":true,\"sub\":null},{\"fileName\":\"游戏\",\"fid\":\"3a7da9c8bce647fabebc8223a1979244\",\"dir\":true,\"sub\":null},{\"fileName\":\"照片\",\"fid\":\"ff81fed0bceb46a39f75d5a02658b580\",\"dir\":true,\"sub\":null},{\"fileName\":\"来自：GALAXY Administrator 电脑备份\",\"fid\":\"aa7594103fdb44808ff607fa47adf674\",\"dir\":true,\"sub\":null}]},{\"fileName\":\"装机\",\"fid\":\"274d9b2de6e84dc1a55a2df8661b3ea2\",\"dir\":true,\"sub\":[]},{\"fileName\":\"来自：分享\",\"fid\":\"c5de7ae030304b93bf359f09ab666882\",\"dir\":true,\"sub\":[{\"fileName\":\"拾光坞\",\"fid\":\"cb73d00dad3a48ca95daf4bd3669af5d\",\"dir\":true,\"sub\":null},{\"fileName\":\"NAT虚拟机设置（校园网适用）\",\"fid\":\"538ad5564be84a10b7ac2402bf6ac4a3\",\"dir\":true,\"sub\":null},{\"fileName\":\"Docker版Openwrt\",\"fid\":\"646ed3efda60487da54830b6573674e3\",\"dir\":true,\"sub\":null},{\"fileName\":\"DockerCompose小结\",\"fid\":\"0302bd4984b94d8f87d7c2c39a71a58e\",\"dir\":true,\"sub\":null},{\"fileName\":\"Alias别名\",\"fid\":\"0472a0fabc8542a592b2b85e304bdc55\",\"dir\":true,\"sub\":null},{\"fileName\":\"iStoreOS如何格式化硬盘\",\"fid\":\"7695b0198bc94dca98d81c19a9c4d873\",\"dir\":true,\"sub\":null},{\"fileName\":\"115挂载分享链接\",\"fid\":\"2f15195cc2fc4b6cbec1b0b8c3755e7e\",\"dir\":true,\"sub\":null},{\"fileName\":\"Alist限速解决方法\",\"fid\":\"f8c154c28206499d9c38a897042e7924\",\"dir\":true,\"sub\":null},{\"fileName\":\"B站视频下载\",\"fid\":\"d7426b73118643f483ba2250a1fd3798\",\"dir\":true,\"sub\":null},{\"fileName\":\"Docker版安卓手机模拟\",\"fid\":\"652a0ea8fc284ef0a1ef119a0b391322\",\"dir\":true,\"sub\":null},{\"fileName\":\"1Panel\",\"fid\":\"4730e809a229433c80e3bd41f5d33d0b\",\"dir\":true,\"sub\":null},{\"fileName\":\"临时\",\"fid\":\"807e9e99a98a4015b3106a24c48b25b7\",\"dir\":true,\"sub\":null},{\"fileName\":\"nxshell终端\",\"fid\":\"0263ad5ad4a949d590ef25e28ecf5490\",\"dir\":true,\"sub\":null},{\"fileName\":\"iStoreOS声卡驱动安装\",\"fid\":\"171e8f59ca6f44ecbc4d8e3d8cae9e5e\",\"dir\":true,\"sub\":null},{\"fileName\":\"Docker版迅雷\",\"fid\":\"2fbf8caeb89c489789aef669815a31c8\",\"dir\":true,\"sub\":null},{\"fileName\":\"Plex\",\"fid\":\"3dcad4bea9944f75a2be3ceac2106fdf\",\"dir\":true,\"sub\":null},{\"fileName\":\"Docker版群晖\",\"fid\":\"41970860445f4fb8a6209c7efa3b37f9\",\"dir\":true,\"sub\":null},{\"fileName\":\"Docker镜像的保存和导入\",\"fid\":\"4259edb5d5f14ec887609519d04d1d71\",\"dir\":true,\"sub\":null},{\"fileName\":\"windows程序自启动\",\"fid\":\"429ae9e3449941758f3f8a705eee2f17\",\"dir\":true,\"sub\":null},{\"fileName\":\"Windows版docker的安装和使用\",\"fid\":\"49d697d6aa95455fa65c50d8bbf58f5d\",\"dir\":true,\"sub\":null},{\"fileName\":\"N1使用iStoreOS的基本设置\",\"fid\":\"4e36649946c14ed29d7945a7e61afd86\",\"dir\":true,\"sub\":null},{\"fileName\":\"修改docker注册表\",\"fid\":\"7c7a428253a34cf8ba3490382d9f923a\",\"dir\":true,\"sub\":null},{\"fileName\":\"TMDB注册\",\"fid\":\"897d653ef0ad468e9a4efc9c2ad5ae25\",\"dir\":true,\"sub\":null},{\"fileName\":\"rufus启动盘制作\",\"fid\":\"34e616a4b21b4638a7c7649daa99df8c\",\"dir\":true,\"sub\":null},{\"fileName\":\"视频小结和观看指南\",\"fid\":\"63cb92cb55df45e59ed10776834accb5\",\"dir\":true,\"sub\":null},{\"fileName\":\"批量修改strm文件\",\"fid\":\"97140be491514428a185f63dfaf2d1af\",\"dir\":true,\"sub\":null},{\"fileName\":\"查看Docker日志\",\"fid\":\"97b6dbf43f6d42ba84260aef3c832c91\",\"dir\":true,\"sub\":null},{\"fileName\":\"115不大助手\",\"fid\":\"bed9778f53d54f99acc7e2f805194966\",\"dir\":true,\"sub\":null},{\"fileName\":\"虚拟机VirtualBox\",\"fid\":\"cc0ebdbd3a5a46189538b7200f9badff\",\"dir\":true,\"sub\":null},{\"fileName\":\"关于夸克和115网盘\",\"fid\":\"d7b5e3e5803c4b36b762ed05040a4603\",\"dir\":true,\"sub\":null},{\"fileName\":\"安卓播放器AfuseKt\",\"fid\":\"e94ba0e1fa624507baf1ce021170a48d\",\"dir\":true,\"sub\":null},{\"fileName\":\"iStoreOS安装iSCSI支持\",\"fid\":\"fca54b33eb174e25971fde1e361188eb\",\"dir\":true,\"sub\":null},{\"fileName\":\"搜索效率提升\",\"fid\":\"407f208edf61410888e74f54b613449b\",\"dir\":true,\"sub\":null},{\"fileName\":\"计划任务\",\"fid\":\"4b2e856ef2f34ebba166f8c47bf445fe\",\"dir\":true,\"sub\":null},{\"fileName\":\"小雅大礼包\",\"fid\":\"03ddae1a55754732ac6bc26798f9621d\",\"dir\":true,\"sub\":null},{\"fileName\":\"portainer\",\"fid\":\"10270ff8e2384626aa3bba2343b454a7\",\"dir\":true,\"sub\":null},{\"fileName\":\"xteve\",\"fid\":\"23d5fb2c3dda498aa02c5e5f82775926\",\"dir\":true,\"sub\":null},{\"fileName\":\"iStoreOS安装无线网卡驱动\",\"fid\":\"3cc8656ff2454ac9bffa9c99dc085ddd\",\"dir\":true,\"sub\":null},{\"fileName\":\"xlist\",\"fid\":\"55f129883906418881fbf7ac9b76eff6\",\"dir\":true,\"sub\":null},{\"fileName\":\"iStoreOS如何进行系统重置Reset\",\"fid\":\"dacbc990b57f4b4c98f58fc214ef6f21\",\"dir\":true,\"sub\":null},{\"fileName\":\"安装和使用NANO\",\"fid\":\"451541a471794d5caf01da72dd6cddcb\",\"dir\":true,\"sub\":null},{\"fileName\":\"家庭服务器\",\"fid\":\"5963f8ef014c4792a5ee30cb10c2a496\",\"dir\":true,\"sub\":null},{\"fileName\":\"飞牛fnOS\",\"fid\":\"24c45d53c5ff43939b5632c40584e858\",\"dir\":true,\"sub\":null},{\"fileName\":\"Alist中调用VLC\",\"fid\":\"369b1295bb4d4c2fbbbdb7b84fe802ae\",\"dir\":true,\"sub\":null},{\"fileName\":\"VirtualBox安装iStoreNAS\",\"fid\":\"755d4b7fd59d4b08b93ec5f5940e64ac\",\"dir\":true,\"sub\":null},{\"fileName\":\"流文件工具auto-symlink\",\"fid\":\"a7071ca716164f30b037779fc22ff511\",\"dir\":true,\"sub\":null},{\"fileName\":\"添加修改docker容器参数\",\"fid\":\"c5af361dfe8949d08baea56782425d7e\",\"dir\":true,\"sub\":null},{\"fileName\":\"群晖系列\",\"fid\":\"da53f6411d7f404d92fd108d123e9c22\",\"dir\":true,\"sub\":null},{\"fileName\":\"Docker版Windows\",\"fid\":\"9c104948b1344b98bf9b371830ad2170\",\"dir\":true,\"sub\":null},{\"fileName\":\"DDNSTO访问\",\"fid\":\"384329cebad54fb2bb68a5e60eee6d64\",\"dir\":true,\"sub\":null}]},{\"fileName\":\"来自：BT磁力链下载\",\"fid\":\"384ea89eb61447e4bb9afc5e9eb31377\",\"dir\":true,\"sub\":[]},{\"fileName\":\"音乐\",\"fid\":\"32b3a56f77304effb007424d3eda3161\",\"dir\":true,\"sub\":[{\"fileName\":\"李志\",\"fid\":\"f74e903bfaf24020b310fab3b821ad37\",\"dir\":true,\"sub\":null},{\"fileName\":\"华晨宇 2013-2023年 所有专辑歌曲合集 无损 \u200B\u200B\u200B\",\"fid\":\"5b8a694aba4142b1ab311cd31082f936\",\"dir\":true,\"sub\":null},{\"fileName\":\"S-苏打绿歌曲合集\",\"fid\":\"d8f9d3067036437fa7f2874d63700d2d\",\"dir\":true,\"sub\":null},{\"fileName\":\"L-林志炫\",\"fid\":\"844061a7ef4342e5a5549d7d58911a06\",\"dir\":true,\"sub\":null},{\"fileName\":\"经典老歌1100首（60-90年代）\",\"fid\":\"856641cdb95d40f3bdcfd37dec8866ca\",\"dir\":true,\"sub\":null},{\"fileName\":\"周杰伦 - 全部专辑 无损 \",\"fid\":\"4866b18e3c84406faf10de6dd9288c90\",\"dir\":true,\"sub\":null},{\"fileName\":\"【无损音乐】陈奕迅歌曲合集\",\"fid\":\"1e2332c4c7a048afa1aee8bd9dd27cba\",\"dir\":true,\"sub\":null},{\"fileName\":\"【无损音乐】陈升歌曲合集-\",\"fid\":\"941158343d334186aa93062899aaa586\",\"dir\":true,\"sub\":null},{\"fileName\":\"D-动力火车\",\"fid\":\"2fd76e2b5d614bea9be76124ed7c8695\",\"dir\":true,\"sub\":null},{\"fileName\":\"Z-赵雷\",\"fid\":\"79220163122c4b2cbbc699380dbdbd5d\",\"dir\":true,\"sub\":null},{\"fileName\":\"汪峰作品最全合集 9.6GB容量\",\"fid\":\"de4120d2c4c549b696be1e76c5f368f2\",\"dir\":true,\"sub\":null},{\"fileName\":\"群星《试音黑胶王》魔音唱片[正版原抓WAV+CUE]\",\"fid\":\"7651ac10e71e41d0954a9e5137610d44\",\"dir\":true,\"sub\":null},{\"fileName\":\"MKV精选1万首 五\",\"fid\":\"7affa0adadc64b5cab393947f7951773\",\"dir\":true,\"sub\":null},{\"fileName\":\"MKV精选1万首 二\",\"fid\":\"e943b62304964c41a402fad500ebeeef\",\"dir\":true,\"sub\":null},{\"fileName\":\"MKV精选1万首 四\",\"fid\":\"8f48ae525413470dbc4ec0e686ce44ae\",\"dir\":true,\"sub\":null},{\"fileName\":\"02网络流行歌曲500首\",\"fid\":\"a6c8d81ca80a4adc974e04f2794bab04\",\"dir\":true,\"sub\":null},{\"fileName\":\"01抖音热门歌曲500首\",\"fid\":\"4ce291dc42d24061861db1c42fbb3275\",\"dir\":true,\"sub\":null},{\"fileName\":\"17网络飙升榜500首\",\"fid\":\"4fb77326fa3147d7b6c40ff404b4a9d5\",\"dir\":true,\"sub\":null},{\"fileName\":\"08流行新歌榜500首\",\"fid\":\"b6e82014b0424c578d4e74c79b210064\",\"dir\":true,\"sub\":null},{\"fileName\":\"13经典珍藏金曲330首\",\"fid\":\"cc060092c36947d3ac020a4d83dab2f9\",\"dir\":true,\"sub\":null},{\"fileName\":\"QQ音乐付费经典华语225首MP3格式（5.93GB）\",\"fid\":\"f8444fac9d8f418f8216f7084467a3f7\",\"dir\":true,\"sub\":null},{\"fileName\":\"03流行中文DJ250首\",\"fid\":\"e66feaab7c0d4cd4b69f54cbf4f69c02\",\"dir\":true,\"sub\":null},{\"fileName\":\"9月份抖音热门歌单推荐\",\"fid\":\"58ef60ddb0694d9ca064d6750552d6fd\",\"dir\":true,\"sub\":null},{\"fileName\":\"04抖音热门歌曲DJ250首\",\"fid\":\"5693150c31c848d99f2cf1d24c9a55a1\",\"dir\":true,\"sub\":null},{\"fileName\":\"网易云评论最多的韩语歌曲TOP200\",\"fid\":\"060710938bb340748f01a877d3326498\",\"dir\":true,\"sub\":null},{\"fileName\":\"05HiFi发烧人声220首\",\"fid\":\"d0f98d63af0046578304214308108466\",\"dir\":true,\"sub\":null},{\"fileName\":\"【无损音乐】张国荣272首歌\",\"fid\":\"07d2c377b577423a872c995e6c65cb55\",\"dir\":true,\"sub\":null},{\"fileName\":\"15经典流行HiFi歌曲200首\",\"fid\":\"0ee47ff9387d43e4b4b8360948b38574\",\"dir\":true,\"sub\":null},{\"fileName\":\"网易云评论最多的日语TOP100\",\"fid\":\"118296a2d2fe4f74997248a3d7874e6a\",\"dir\":true,\"sub\":null},{\"fileName\":\"网易云评论最多的英文TOP100\",\"fid\":\"bbed2eeffe9547148719b08db81cb92a\",\"dir\":true,\"sub\":null},{\"fileName\":\"洗脑电音↓魔幻绕耳｜沉溺其白\",\"fid\":\"306212e4e0c9430d8ab4e252b9820fe7\",\"dir\":true,\"sub\":null},{\"fileName\":\"10闽南语金曲100首\",\"fid\":\"d110af2f71c04af89cf889fd7680a959\",\"dir\":true,\"sub\":null},{\"fileName\":\"钢琴纯音乐迷必备歌单166首\",\"fid\":\"970d61ba45744f2a99c16d9667149189\",\"dir\":true,\"sub\":null},{\"fileName\":\"07经典金曲榜70首\",\"fid\":\"0ba2cb24406e4518bd356d1416a0d11d\",\"dir\":true,\"sub\":null},{\"fileName\":\"网易云评论最多的粤语歌曲TOP100\",\"fid\":\"767e50a05a0e4b2e8bef5410b031a834\",\"dir\":true,\"sub\":null},{\"fileName\":\"12嘻哈潮人说唱100首\",\"fid\":\"b3ee40ea022f4106a8484a1df61510bd\",\"dir\":true,\"sub\":null},{\"fileName\":\"16天籁轻音乐50首\",\"fid\":\"6592c7d3626541e290de215d05a7a5d8\",\"dir\":true,\"sub\":null},{\"fileName\":\"11草原天籁之音70首\",\"fid\":\"0c563ce4beab4d168d4a4fef44ef6a6f\",\"dir\":true,\"sub\":null},{\"fileName\":\"9月份热门歌单明星刘德华\",\"fid\":\"9cdbab11c83842fca28a8f735fce749c\",\"dir\":true,\"sub\":null},{\"fileName\":\"18纯真童声50首\",\"fid\":\"b8e92ec836d040a396fa7db34cc87191\",\"dir\":true,\"sub\":null},{\"fileName\":\"14经典无损人声合唱100首\",\"fid\":\"f8192a4048fb4d0da76aa7a38ebb1d99\",\"dir\":true,\"sub\":null},{\"fileName\":\"09精选民谣60首\",\"fid\":\"89fb618c760b4aafb737107a765fc5d3\",\"dir\":true,\"sub\":null},{\"fileName\":\"06经典流行8090歌曲100首\",\"fid\":\"1e04fbd3385540659755d59b220a1bbf\",\"dir\":true,\"sub\":null},{\"fileName\":\"张宇精选\",\"fid\":\"4819a9370a744726bc5d0596d1631442\",\"dir\":true,\"sub\":null},{\"fileName\":\"9月份热门歌单（赵丽颖）\",\"fid\":\"73a24b0b14b04dcc94184ffef23ae7bf\",\"dir\":true,\"sub\":null},{\"fileName\":\"19广场舞流行歌曲50首\",\"fid\":\"1094d85a4dc742d9849bc277d02bcf1c\",\"dir\":true,\"sub\":null},{\"fileName\":\"【无损音乐】张信哲 34张专辑 无损wav\",\"fid\":\"2ee6ab1544184e00bb51e0fe5648e8b2\",\"dir\":true,\"sub\":null},{\"fileName\":\"2023刀郎新歌《翩翩》高清纯享版MV-\",\"fid\":\"12dd3d9534d6419d998552b5de75548e\",\"dir\":true,\"sub\":null}]},{\"fileName\":\"云文件\",\"fid\":\"4f91b74ecc804bcfb6652f920967f909\",\"dir\":true,\"sub\":[]},{\"fileName\":\"夸克快传\",\"fid\":\"71e041c598b34c34a4591411b4ed4143\",\"dir\":true,\"sub\":[]},{\"fileName\":\"夸克上传文件\",\"fid\":\"5521b8c1f10645a5ae9707de5f379916\",\"dir\":true,\"sub\":[]},{\"fileName\":\"来自：云收藏\",\"fid\":\"f50ee6be804a4d95861ceafccb648974\",\"dir\":true,\"sub\":[]}]";

//        QuarkAccount account = quarkAccountService.getById(1L);
//        QuarkPanFileManager manager = new QuarkPanFileManager(account.getCookie());
//
//        List<QuarkFileListBo.QuarkFileListItemBo> fileListItemBoList = getQuarkFileListItemBos(pdirFid, manager);
        List<QuarkFileListBo.QuarkFileListItemBo> fileListItemBoList = JSONArray.parseArray(json, QuarkFileListBo.QuarkFileListItemBo.class);
        return Result.OK(fileListItemBoList);
    }

    private List<QuarkFileListBo.QuarkFileListItemBo> getQuarkFileListItemBos(String pdirFid, QuarkPanFileManager manager) {
        // 初始调用时从第1级开始
        return getQuarkFileListItemBos(pdirFid, manager, 1);
    }

    private List<QuarkFileListBo.QuarkFileListItemBo> getQuarkFileListItemBos(String pdirFid, QuarkPanFileManager manager, int currentDepth) {
        // 最大深度为3，超过则不再继续递归
        final int maxDepth = 2;

        List<QuarkFileListBo.QuarkFileListItemBo> fileListItemBoList;
        try {
            // 获取当前文件夹下的文件列表
            fileListItemBoList = manager.sort(pdirFid);

            // 只有在当前深度小于最大深度时才递归处理子文件夹
            if (currentDepth < maxDepth) {
                for (QuarkFileListBo.QuarkFileListItemBo fileItem : fileListItemBoList) {
                    if (Boolean.TRUE.equals(fileItem.getDir())) {
                        // 递归调用，传递当前深度+1
                        List<QuarkFileListBo.QuarkFileListItemBo> subFiles = getQuarkFileListItemBos(fileItem.getFid(), manager, currentDepth + 1);
                        subFiles = subFiles.stream().filter(t->Boolean.TRUE.equals(t.getDir())).collect(Collectors.toList());
                        fileItem.setSub(subFiles);
                    }
                }
            }
        } catch (Exception e) {
            // 使用自定义异常或其他处理逻辑
            throw new RuntimeException("Failed to retrieve file list for fid: " + pdirFid, e);
        }
        return fileListItemBoList;
    }

}
